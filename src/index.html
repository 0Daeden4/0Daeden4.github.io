<!DOCTYPE html>
<html lang="en" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Project Menu</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.9.0/p5.min.js"></script>
    <style>
        body {
            margin: 0;
            overflow: hidden;
            background-color: #000;
            cursor: none;
        }
        #defaultCanvas0 {
            position: fixed;
            top: 0;
            left: 0;
            z-index: -1;
        }
        #cursor-canvas {
            position: fixed;
            top: 0;
            left: 0;
            z-index: 9999;
            pointer-events: none;
        }
        #menu-container {
            position: relative;
            z-index: 10;
            height: 100vh;
            width: 100vw;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            gap: 1.5rem;
        }
    </style>
</head>
<body>

    <div id="menu-container"></div>
    <canvas id="cursor-canvas"></canvas>

    <script>
        const PROJECT_LIST = [
            { name: "Graph Visualization Space", file: "graphviz.html" },
        ];

        const container = document.getElementById('menu-container');

	PROJECT_LIST.forEach(project => {
            const link = document.createElement('a');
            link.href = project.file;
            link.className = 'group relative inline-flex h-12 items-center justify-center overflow-hidden rounded-md border-2 border-[var(--btn-border)] font-medium cursor-none text-white';

            link.innerHTML = `
                <div class="inline-flex h-12 translate-y-0 items-center justify-center px-6 bg-gradient-to-r from-[var(--btn-grad-1)] to-[var(--btn-grad-2)] text-white transition duration-500 group-hover:-translate-y-[150%]">
                    ${project.name}
                </div>
                <div class="absolute inline-flex h-20 w-full translate-y-full items-center justify-center text-neutral-50 transition duration-500 group-hover:translate-y-0">
                    <span class="absolute h-full w-full translate-y-full skew-y-12 scale-y-0 bg-[var(--btn-hover)] transition duration-500 group-hover:translate-y-0 group-hover:scale-150"></span>
                    <span class="z-10">${project.name}</span>
                </div>
            `;
            container.appendChild(link);
        });

	const deg = (a) => Math.PI / 180 * a;
        const rand = (v1, v2) => Math.floor(v1 + Math.random() * (v2 - v1));

        const opt = {
            particles: window.innerWidth / 500 ? 1000 : 500,
            noiseScale: 0.009,
            angle: Math.PI / 180 * -90,
            h1: rand(0, 360),
            h2: rand(0, 360),
            s1: rand(20, 90),
            s2: rand(20, 90),
            l1: rand(30, 80),
            l2: rand(30, 80),
            strokeWeight: 1.2,
            tail: 82,
        };

        function updateTheme() {
            const root = document.documentElement;
            root.style.setProperty('--btn-border', `hsl(${opt.h1}, ${opt.s1}%, ${opt.l1}%, 0.5)`);
            root.style.setProperty('--btn-grad-1', `hsla(${opt.h1}, ${opt.s1}%, ${opt.l1}%, 0.3)`);
            root.style.setProperty('--btn-grad-2', `hsla(${opt.h2}, ${opt.s2}%, ${opt.l2}%, 0.3)`);
            root.style.setProperty('--btn-hover', `hsl(${opt.h2}, ${opt.s2}%, ${opt.l2}%, 0.4)`);
        }

        const Particles = [];
        let time = 0;

        updateTheme();

        document.body.addEventListener('click', () => {
            opt.h1 = rand(0, 360);
            opt.h2 = rand(0, 360);
            opt.s1 = rand(20, 90);
            opt.s2 = rand(20, 90);
            opt.l1 = rand(30, 80);
            opt.l2 = rand(30, 80);
            opt.angle += deg(rand(60, 60)) * (Math.random() > .5 ? 1 : -1);

            updateTheme();

            for (let p of Particles) {
                p.randomize();
            }
        });

        class Particle {
            constructor(x, y) {
                this.x = x;
                this.y = y;
                this.lx = x;
                this.ly = y;
                this.vx = 0;
                this.vy = 0;
                this.ax = 0;
                this.ay = 0;
                this.hueSemen = Math.random();
                this.hue = this.hueSemen > .5 ? 20 + opt.h1 : 20 + opt.h2;
                this.sat = this.hueSemen > .5 ? opt.s1 : opt.s2;
                this.light = this.hueSemen > .5 ? opt.l1 : opt.l2;
                this.maxSpeed = this.hueSemen > .5 ? 3 : 2;
            }

            randomize() {
                this.hueSemen = Math.random();
                this.hue = this.hueSemen > .5 ? 20 + opt.h1 : 20 + opt.h2;
                this.sat = this.hueSemen > .5 ? opt.s1 : opt.s2;
                this.light = this.hueSemen > .5 ? opt.l1 : opt.l2;
                this.maxSpeed = this.hueSemen > .5 ? 3 : 2;
            }

            update() {
                this.follow();
                this.vx += this.ax;
                this.vy += this.ay;

                var p = Math.sqrt(this.vx * this.vx + this.vy * this.vy);
                var a = Math.atan2(this.vy, this.vx);
                var m = Math.min(this.maxSpeed, p);
                this.vx = Math.cos(a) * m;
                this.vy = Math.sin(a) * m;

                this.x += this.vx;
                this.y += this.vy;
                this.ax = 0;
                this.ay = 0;

                this.edges();
            }

            follow() {
                let angle = (noise(this.x * opt.noiseScale, this.y * opt.noiseScale, time * opt.noiseScale)) * Math.PI * 0.5 + opt.angle;
                this.ax += Math.cos(angle);
                this.ay += Math.sin(angle);
            }

            updatePrev() {
                this.lx = this.x;
                this.ly = this.y;
            }

            edges() {
                if (this.x < 0) { this.x = width; this.updatePrev(); }
                if (this.x > width) { this.x = 0; this.updatePrev(); }
                if (this.y < 0) { this.y = height; this.updatePrev(); }
                if (this.y > height) { this.y = 0; this.updatePrev(); }
            }

            render() {
                stroke(`hsla(${this.hue}, ${this.sat}%, ${this.light}%, .5)`);
                line(this.x, this.y, this.lx, this.ly);
                this.updatePrev();
            }
        }

        function setup() {
            createCanvas(windowWidth, windowHeight);
            for (let i = 0; i < opt.particles; i++) {
                Particles.push(new Particle(Math.random() * width, Math.random() * height));
            }
            strokeWeight(opt.strokeWeight);
        }

        function draw() {
            time++;
            background(0, 100 - opt.tail);
            for (let p of Particles) {
                p.update();
                p.render();
            }
        }

        function windowResized() {
            resizeCanvas(windowWidth, windowHeight);
        }

        (function() {
            function n(e) { this.init(e || {}); }
            n.prototype = {
                init: function (e) {
                    this.phase = e.phase || 0;
                    this.offset = e.offset || 0;
                    this.frequency = e.frequency || 0.001;
                    this.amplitude = e.amplitude || 1;
                },
                update: function () {
                    this.phase += this.frequency;
                    return this.offset + Math.sin(this.phase) * this.amplitude;
                },
                value: function () { return this.e; }
            };

            function Line(e) { this.init(e || {}); }
            Line.prototype = {
                init: function (e) {
                    this.spring = e.spring + 0.1 * Math.random() - 0.02;
                    this.friction = E.friction + 0.01 * Math.random() - 0.002;
                    this.nodes = [];
                    for (var t, n = 0; n < E.size; n++) {
                        t = new Node();
                        t.x = pos.x;
                        t.y = pos.y;
                        this.nodes.push(t);
                    }
                },
                update: function () {
                    var e = this.spring, t = this.nodes[0];
                    t.vx += (pos.x - t.x) * e;
                    t.vy += (pos.y - t.y) * e;
                    for (var n, i = 0, a = this.nodes.length; i < a; i++) {
                        t = this.nodes[i];
                        if (0 < i) {
                            n = this.nodes[i - 1];
                            t.vx += (n.x - t.x) * e;
                            t.vy += (n.y - t.y) * e;
                            t.vx += n.vx * E.dampening;
                            t.vy += n.vy * E.dampening;
                        }
                        t.vx *= this.friction;
                        t.vy *= this.friction;
                        t.x += t.vx;
                        t.y += t.vy;
                        e *= E.tension;
                    }
                },
                draw: function () {
                    var e, t, n = this.nodes[0].x, i = this.nodes[0].y;
                    ctx.beginPath();
                    ctx.moveTo(n, i);
                    for (var a = 1, o = this.nodes.length - 2; a < o; a++) {
                        e = this.nodes[a];
                        t = this.nodes[a + 1];
                        n = 0.5 * (e.x + t.x);
                        i = 0.5 * (e.y + t.y);
                        ctx.quadraticCurveTo(e.x, e.y, n, i);
                    }
                    e = this.nodes[a];
                    t = this.nodes[a + 1];
                    ctx.quadraticCurveTo(e.x, e.y, t.x, t.y);
                    ctx.stroke();
                    ctx.closePath();
                }
            };

            function onMousemove(e) {
                function o() {
                    lines = [];
                    for (var e = 0; e < E.trails; e++)
                        lines.push(new Line({ spring: 0.4 + (e / E.trails) * 0.025 }));
                }
                function c(e) {
                    if(e.touches) {
                        pos.x = e.touches[0].pageX;
                        pos.y = e.touches[0].pageY;
                    } else {
                        pos.x = e.clientX;
                        pos.y = e.clientY;
                    }
                }
                function l(e) {
                    if(e.touches && e.touches.length == 1) {
                        pos.x = e.touches[0].pageX;
                        pos.y = e.touches[0].pageY;
                    }
                }
                document.removeEventListener('mousemove', onMousemove);
                document.removeEventListener('touchstart', onMousemove);
                document.addEventListener('mousemove', c);
                document.addEventListener('touchmove', c);
                document.addEventListener('touchstart', l);
                c(e);
                o();
                renderCursor();
            }

            function renderCursor() {
                if (ctx.running) {
                    ctx.globalCompositeOperation = 'source-over';
                    ctx.clearRect(0, 0, ctx.canvas.width, ctx.canvas.height);
                    ctx.globalCompositeOperation = 'lighter';

                    const hue = opt ? opt.h1 : Math.round(f.update());
                    ctx.strokeStyle = 'hsla(' + hue + ',50%,50%,0.5)';
                    ctx.lineWidth = 1;

                    for (var e, t = 0; t < E.trails; t++) {
                        e = lines[t];
                        e.update();
                        e.draw();
                    }
                    ctx.frame++;
                    window.requestAnimationFrame(renderCursor);
                }
            }

            function resizeCursorCanvas() {
                ctx.canvas.width = window.innerWidth;
                ctx.canvas.height = window.innerHeight;
            }

            var ctx, f, e = 0, pos = {x: 0, y: 0}, lines = [];
            var E = {
                debug: true,
                friction: 0.5,
                trails: 20,
                size: 50,
                dampening: 0.25,
                tension: 0.98,
            };

            function Node() {
                this.x = 0; this.y = 0; this.vy = 0; this.vx = 0;
            }

            const initCursor = function () {
                ctx = document.getElementById('cursor-canvas').getContext('2d');
                ctx.running = true;
                ctx.frame = 1;
                f = new n({
                    phase: Math.random() * 2 * Math.PI,
                    amplitude: 85,
                    frequency: 0.0015,
                    offset: 285,
                });

                resizeCursorCanvas();

                document.addEventListener('mousemove', onMousemove);
                document.addEventListener('touchstart', onMousemove);
                window.addEventListener('resize', resizeCursorCanvas);

                window.addEventListener('focus', () => {
                    if (!ctx.running) {
                        ctx.running = true;
                        renderCursor();
                    }
                });
                window.addEventListener('blur', () => {
                    ctx.running = true;
                });
            };

            if (document.readyState === 'complete' || document.readyState === 'interactive') {
                initCursor();
            } else {
                document.addEventListener('DOMContentLoaded', initCursor);
            }
        })();
    </script>
</body>
</html>
